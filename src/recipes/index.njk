---
layout: layouts/base.njk
title: All Recipes
---
<div class="max-w-6xl mx-auto px-4 py-8">
    <h1 class="text-4xl font-bold mb-8 text-center text-gray-800">All Recipes</h1>
    
    <!-- Search Status -->
    <div id="search-status" class="hidden mb-8 text-center">
        <div class="inline-flex items-center gap-3 bg-pink-50 px-4 py-2 rounded-full border border-pink-100">
            <span class="text-gray-700">Searching for: <span id="search-term-display" class="font-bold text-pink-600"></span></span>
            <button id="clear-search" class="text-gray-400 hover:text-gray-600 transition-colors" title="Clear search">
                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
        </div>
    </div>

    <!-- Category Filter -->
    <div class="mb-12 pt-4">
        <h2 class="text-xl font-semibold text-gray-700 mb-4">Browse by Category</h2>
        <div class="category-slider pt-2" id="category-filters">
            <button class="category-btn active" data-category="all">
                <span class="category-icon">üçΩÔ∏è</span>
                <span class="category-label">All</span>
            </button>
            <button class="category-btn" data-category="featured">
                <span class="category-icon">‚≠ê</span>
                <span class="category-label">Featured</span>
            </button>
            <button class="category-btn" data-category="vegetarian">
                <span class="category-icon">ü•ó</span>
                <span class="category-label">Vegetarian</span>
            </button>
            <button class="category-btn" data-category="vegan">
                <span class="category-icon">üå±</span>
                <span class="category-label">Vegan</span>
            </button>
            <button class="category-btn" data-category="dessert">
                <span class="category-icon">üç∞</span>
                <span class="category-label">Dessert</span>
            </button>
            <button class="category-btn" data-category="breakfast">
                <span class="category-icon">ü•û</span>
                <span class="category-label">Breakfast</span>
            </button>
            <button class="category-btn" data-category="dinner">
                <span class="category-icon">üçú</span>
                <span class="category-label">Dinner</span>
            </button>
            <button class="category-btn" data-category="healthy">
                <span class="category-icon">üí™</span>
                <span class="category-label">Healthy</span>
            </button>
            <button class="category-btn" data-category="quick-easy">
                <span class="category-icon">‚ö°</span>
                <span class="category-label">Quick & Easy</span>
            </button>
        </div>
    </div>
    
    <!-- Recipe Grid Container -->
    <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8" id="recipes-grid">
        <!-- Recipes will be populated here by JS -->
    </div>

    <!-- Pagination Controls -->
    <div class="flex justify-center items-center mt-12 space-x-4" id="pagination-controls">
        <!-- Pagination buttons will be populated here by JS -->
    </div>
</div>

<script>
    // Generate lightweight JSON index
    const ALL_RECIPES = [
        {% for recipe in collections.recipes %}
        {
            title: `{{ recipe.data.title | replace("`", "'") }}`,
            url: "{{ recipe.url }}",
            thumbnail: "{{ recipe.data.thumbnail }}",
            description: `{{ recipe.data.description | replace("`", "'") }}`,
            tags: [{% if recipe.data.tags %}"{{ recipe.data.tags | join('","') | safe }}"{% endif %}],
            cooking_time: "{{ recipe.data.cooking_time }}"
        }{% if not loop.last %},{% endif %}
        {% endfor %}
    ];

    const ITEMS_PER_PAGE = 6;
    let currentPage = 1;
    let currentCategory = 'all';
    let searchQuery = '';
    let filteredRecipes = [];

    const gridContainer = document.getElementById('recipes-grid');
    const paginationContainer = document.getElementById('pagination-controls');
    const categoryButtons = document.querySelectorAll('.category-btn');
    const searchStatus = document.getElementById('search-status');
    const searchTermDisplay = document.getElementById('search-term-display');
    const clearSearchBtn = document.getElementById('clear-search');

    function filterRecipes() {
        let recipes = ALL_RECIPES;
        
        // Apply category filter
        if (currentCategory !== 'all') {
            recipes = recipes.filter(recipe => recipe.tags.includes(currentCategory));
        }
        
        // Apply search filter
        if (searchQuery.trim() !== '') {
            const query = searchQuery.toLowerCase();
            recipes = recipes.filter(recipe => {
                const titleMatch = recipe.title.toLowerCase().includes(query);
                const descMatch = recipe.description.toLowerCase().includes(query);
                return titleMatch || descMatch;
            });
            
            // Show search status
            searchStatus.classList.remove('hidden');
            searchTermDisplay.textContent = searchQuery;
        } else {
            // Hide search status
            searchStatus.classList.add('hidden');
        }
        
        filteredRecipes = recipes;
        currentPage = 1; // Reset to first page on filter change
        renderRecipes();
        renderPagination();
    }

    // Clear Search
    clearSearchBtn.addEventListener('click', () => {
        searchQuery = '';
        
        // Clear URL parameter without reloading
        const url = new URL(window.location);
        url.searchParams.delete('q');
        window.history.pushState({}, '', url);
        
        // Clear nav search input if it exists
        const navSearchInput = document.getElementById('nav-search-input');
        if (navSearchInput) {
            navSearchInput.value = '';
        }
        
        filterRecipes();
    });

    function renderRecipes() {
        gridContainer.innerHTML = '';
        
        const start = (currentPage - 1) * ITEMS_PER_PAGE;
        const end = start + ITEMS_PER_PAGE;
        const pageItems = filteredRecipes.slice(start, end);

        if (pageItems.length === 0) {
            const message = searchQuery.trim() !== '' 
                ? `No recipes found matching "${searchQuery}"`
                : 'No recipes found for this category.';
            gridContainer.innerHTML = `<p class="col-span-full text-center text-gray-500 text-lg">${message}</p>`;
            return;
        }

        pageItems.forEach(recipe => {
            const card = document.createElement('a');
            card.href = recipe.url;
            card.className = 'recipe-card relative bg-white rounded-xl shadow-md overflow-hidden hover:shadow-xl transition-all duration-300 hover:-translate-y-1 block aspect-square group';
            
            let thumbnailHtml = '';
            if (recipe.thumbnail) {
                thumbnailHtml = `<img src="${recipe.thumbnail}" alt="${recipe.title}" class="absolute inset-0 w-full h-full object-cover transition-transform duration-500 group-hover:scale-105">`;
            }

            let cookingTimeHtml = '';
            if (recipe.cooking_time) {
                cookingTimeHtml = `<span class="bg-white/20 backdrop-blur-sm text-white px-3 py-1 rounded-full">‚è±Ô∏è ${recipe.cooking_time}</span>`;
            }

            card.innerHTML = `
                ${thumbnailHtml}
                <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent"></div>
                <div class="absolute bottom-0 left-0 right-0 p-6">
                    <h2 class="text-xl font-bold text-white mb-3 group-hover:text-pink-300 transition-colors line-clamp-2">${recipe.title}</h2>
                    <div class="flex justify-between items-center text-sm">
                        ${cookingTimeHtml}
                        <span class="bg-pink-500 text-white px-3 py-1 rounded-full text-xs font-bold">View Recipe &rarr;</span>
                    </div>
                </div>
            `;
            gridContainer.appendChild(card);
        });
    }

    function renderPagination() {
        paginationContainer.innerHTML = '';
        const totalPages = Math.ceil(filteredRecipes.length / ITEMS_PER_PAGE);

        if (totalPages <= 1) return;

        // Previous Button
        const prevBtn = document.createElement(currentPage > 1 ? 'button' : 'span');
        prevBtn.className = currentPage > 1 
            ? 'px-4 py-2 bg-white text-pink-500 border border-pink-500 rounded-full hover:bg-pink-50 transition-colors font-semibold cursor-pointer'
            : 'px-4 py-2 text-gray-400 border border-gray-200 rounded-full cursor-not-allowed';
        prevBtn.textContent = '‚Üê Previous';
        if (currentPage > 1) {
            prevBtn.onclick = () => {
                currentPage--;
                renderRecipes();
                renderPagination();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };
        }
        paginationContainer.appendChild(prevBtn);

        // Page Info
        const pageInfo = document.createElement('span');
        pageInfo.className = 'text-gray-600 font-medium';
        pageInfo.textContent = `Page ${currentPage} of ${totalPages}`;
        paginationContainer.appendChild(pageInfo);

        // Next Button
        const nextBtn = document.createElement(currentPage < totalPages ? 'button' : 'span');
        nextBtn.className = currentPage < totalPages
            ? 'px-4 py-2 bg-pink-500 text-white border border-pink-500 rounded-full hover:bg-pink-600 transition-colors font-semibold cursor-pointer'
            : 'px-4 py-2 text-gray-400 border border-gray-200 rounded-full cursor-not-allowed';
        nextBtn.textContent = 'Next ‚Üí';
        if (currentPage < totalPages) {
            nextBtn.onclick = () => {
                currentPage++;
                renderRecipes();
                renderPagination();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };
        }
        paginationContainer.appendChild(nextBtn);
    }

    // Event Listeners
    categoryButtons.forEach(btn => {
        btn.addEventListener('click', () => {
            // Update active state
            categoryButtons.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');

            // Update filter
            currentCategory = btn.dataset.category;
            filterRecipes();
        });
    });

    // Check for search query in URL
    const urlParams = new URLSearchParams(window.location.search);
    const urlSearchQuery = urlParams.get('q');
    if (urlSearchQuery) {
        searchQuery = urlSearchQuery;
        // Update nav search input if it exists
        const navSearchInput = document.getElementById('nav-search-input');
        if (navSearchInput) {
            navSearchInput.value = searchQuery;
        }
    }

    // Initial Render
    filterRecipes();
</script>
